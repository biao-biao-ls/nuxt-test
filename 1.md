## 背景

我们集成了 `quickCep` 第三方在线聊天窗口，集成后会在我们的界面中以`iframe`的方式加载聊天窗口；
`quickCep` 提供了全局 `api` 来支持我们进行功能自定义：
```ts
declare global {
  interface Window {
    quickChatReadyHook?: () => void;
    quickEmitter?: {
      on: (event: string, callback: (config: any) => void) => void;
    };
    quickChatApi?: {
       // 设置值到输入框
      setInInputValue: (value: string) => void;
      // 直接发送消息
      sendMessage: (value: string) => void;
      // 触发获取所有座席状态
      emitGetAllOperatorStatus: (operators: string[]) => void;
      // 挂载到底部弹窗
      bottomCustomDrawer: {
        mount: (renderFn: (container: HTMLElement, shadowRoot: ShadowRoot) => void) => void;
        setIsShow: (isShow: boolean) => void;
      };
      // 挂载到左侧弹窗 (移动端使用)
      leftCustomDrawer: {
        mount: (renderFn: (container: HTMLElement, shadowRoot: ShadowRoot) => void) => void;
        setIsShow: (isShow: boolean) => void;
      };
      // 挂载到头部
      customHeader: {
        mount: (renderFn: (container: HTMLElement, shadowRoot: ShadowRoot) => void) => void;
      };
      // 挂载到底部按钮区域
      customFooter: {
        mount: (renderFn: (container: HTMLElement, shadowRoot: ShadowRoot) => void) => void;
      };
      // 挂载到侧边栏
      customLeftBar: {
        mount: (renderFn: (container: HTMLElement, shadowRoot: ShadowRoot) => void) => void;
        setIsShow: (isShow: boolean) => void;
      };
      // 切换座席
      switchChat: (userId: string) => void
    };
  }
}
```

触发获取座席状态数据:

```ts
window.quickChatApi.emitGetAllOperatorStatus([]);
```

监听座席数据更新:

```ts
window.quickEmitter.on('chat.operator.status', (data: { operatorUserIdStatus: Record<string, number> }) => {
    console.log('operatorData', data);
    // {
    // "operatorUserIdStatus": {
    //    "1922621280413200385": 2
    // }
    // 1是离线 2 在线空闲 3 在线忙碌 和其他
}
});
```

切换座席:

```ts
window.quickChatApi.switchChat('123123');
```

监听切换座席成功:

```ts
 window.quickEmitter.on(
          'chat.switch.operator.success',
          () => {
            console.log('切换座席成功');
          }
    );
```

监听点击聊天icon:

```ts
 window.quickEmitter.on(
          'chat.model.toggleChat',
          (data: { isOpen:boolean }) => {
            console.log('点击聊天探头');
          }
    );
```

监听成功获取消息列表 (用于自定义渲染组件时机):

```ts
 window.quickEmitter.on(
          'chat.getMessageList.success',
          (data) => {
            console.log('拉取消息列表成功');
          }
    );
```

监听会话关闭:

```ts
 window.quickEmitter.on('chat.end', (data) => {
   console.log('chat.end', data);
 });
```

监听当前会话座席变化:

```ts
 window.quickEmitter.on('chat.operatorList.change', (data) => {
    console.log('chat.operatorList.change', data);
 });
```

示例如下:

```ts
window.quickChatReadyHook = function () {
      if (window.quickEmitter) {
        window.quickEmitter.on('chat.operator.status', (data: { operatorUserIdStatus: Record<string, number> }) => {
          console.log('operatorData', data);
        });
        if (window.quickChatApi) {
          window.quickChatApi.emitGetAllOperatorStatus([]);
          window.quickChatApi.customHeader.mount((container: HTMLElement) => {
            const root = ReactDOM.createRoot(container);
            root.render(<MyHeader />);
          });
          window.quickChatApi.customFooter.mount((container: HTMLElement) => {
            const root = ReactDOM.createRoot(container);
            root.render(<MyBtn />);
          });
          window.quickChatApi.customLeftBar.mount(
            (container: HTMLElement, shadowRoot) => {
              // 注入自定义样式
              const customStyle = document.createElement('style');
              customStyle.textContent = `
                  .leftBarWrapper {
                    color: blue
                  }
                `;
              shadowRoot.appendChild(customStyle);

              // 注入客户的代码
              const root = ReactDOM.createRoot(container);
              root.render(<LeftBar />);
            }
          );
        } else {
          console.warn('quickChatApi is not ready yet');
        }
      } else {
        console.warn('quickEmitter is not ready yet');
      }
    };
```

我们把 `quickCep` 的功能都集成到了 `packages\shared\utils\quickCep` 供外部调用

## 目标

现需要实现功能：点击自定义底部区域`.chat-foote`, 展示选择订单弹框。

之前已经使用 `vue` 写过该订单选择弹框，但现在需要集成到 `quickCep` 的 `iframe` 中, `iframe` 的 id 为 `quick-chat-iframe`, 我需要将之前使用 `VUE` 实现的逻辑和交互，改写成 `html` 代码插入 `iframe` 中 id 为 `chat-wrap`的 元素；

以前的 `vue` 代码位置为 `im-chat-new/components/ChatPopup.vue`

接口 `/api/overseas-pcb-order/v1/im/selectMyShoppingCart` 的模拟响应数据为：`selectMyShoppingCart.json`

接口 `/api/overseas-im-platform/orderCenter/simpleOrder` 的模拟响应数据为：`simpleOrder.json`
